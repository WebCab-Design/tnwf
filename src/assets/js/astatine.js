/*
	version: 1.1.0
	title: astatine
	author: alexander elias
*/
!function(){"use strict";function t(t){if(!t)throw new Error("Astatine.ajax: requires options");t.action||(t.action=window.location.pathname),t.enctype||(t.enctype="text/plain"),t.method?t.method=t.method.toUpperCase():t.method="GET",t.data&&("GET"===t.method?(t.action=t.action+"?"+n(t.data),t.data=null):t.enctype.search("application/x-www-form-urlencoded")!==-1?t.data=n(t.data):t.enctype.search("application/json")!==-1&&(t.data=JSON.stringify(t.data)));var e=new XMLHttpRequest;if(e.open(t.method,t.action,!0,t.username,t.password),t.mimeType&&e.overrideMimeType(t.mimeType),t.withCredentials&&(e.withCredentials=t.withCredentials),t.headers)for(var i in t.headers)e.setRequestHeader(i,t.headers[i]);e.onreadystatechange=function(){if(4===e.readyState)if(e.status>=200&&e.status<300){if(t.success)return t.success(e)}else if(t.error)return t.error(e)},e.send(t.data)}function e(e){if(!e)throw new Error("Astatine.submit: requires options");if(!e.query)throw new Error("Astatine.submit: requires options.query");r(e.query,function(n,r,o){o&&(o.style.display="block"),r&&(r.style.display="none"),e.data=e.data||i(n),e.action=e.action||n.getAttribute("action"),e.method=e.method||n.getAttribute("method"),e.enctype=e.enctype||n.getAttribute("enctype"),e.headers=e.headers||{"Content-Type":e.enctype},e.prepare&&e.prepare(e.data),e.success=function(t){if(o&&(o.style.display="none"),r&&(r.style.display="block"),n.reset(),e.complete)return e.complete(null,t)},e.error=function(t){if(o&&(o.style.display="none"),r&&(r.style.display="block"),e.data=null,e.complete)return e.complete(t,null)},t(e)})}function n(t){var e="";for(var n in t)e=e.length>0?e+"&":e,e=e+encodeURIComponent(n)+"="+encodeURIComponent(t[n]);return e}function i(t){for(var e=t.querySelectorAll("input, textarea, select"),n={},i=0,r=e.length;i<r;i++){var o=e[i],a=o.name,s=o.type,c=o.value,d=o.checked,u=o.disabled;if(a&&!u&&"submit"!==s&&"reset"!==s&&"button"!==s&&"file"!==s)if("checkbox"===s)n[a]=d;else if("radio"===s)d&&(n[a]=c);else if("select-one"===s||"select-multiple"===s){n[a]=[];for(var l=0,p=o.selectedOptions.length;l<p;l++)n[a].push(o.selectedOptions[l].value);n[a]=n[a].join(", ")}else n[a]=c}return n}function r(t,e){var n="string"==typeof t?document.querySelector(t):t,i=document.createElement("div");i.classList.add("spinner"),n.appendChild(i),n.addEventListener("submit",function(t){t.preventDefault();var n=t.target,r=n.querySelector("[type=submit]");return e(n,r,i)})}function o(t){return"\n\t.spinner {\n\t\tmargin: auto;\n\t\tdisplay: none;\n\t\twidth:  "+t.thickness+";\n\t\theight:  "+t.thickness+";\n\t\tborder:  "+t.size+" solid "+t.colorBottom+";\n\t\tborder-top: "+t.size+" solid "+t.colorTop+";\n\t\tborder-radius: 50%;\n\t\tanimation: spin 2s linear infinite;\n\t\t-o-animation: spin 2s linear infinite;\n\t\t-moz-animation: spin 2s linear infinite;\n\t\t-webkit-animation: spin 2s linear infinite;\n\t}\n\t@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }\n\t@-o-keyframes spin { 0% { -o-transform: rotate(0deg); } 100% { -o-transform: rotate(360deg); } }\n\t@-moz-keyframes spin { 0% { -moz-transform: rotate(0deg); } 100% { -moz-transform: rotate(360deg); } }\n\t@-webkit-keyframes spin { 0% { -webkit-transform: rotate(0deg); }100% { -webkit-transform: rotate(360deg); } }"}function a(t){var e=document.head,n=e.querySelector("[title=Astatine]"),i=o(t),r=document.createElement("style"),a=document.createTextNode(i);r.setAttribute("title","Astatine"),r.appendChild(a),n?e.replaceChild(r,n):document.head.appendChild(r)}var s={setup:{spinner:{s:"3px",t:"15px",ct:"darkgray",cb:"lightgray"}},ajax:t,submit:e,formData:i,serialize:n};Object.defineProperties(s.setup.spinner,{size:{get:function(){return this.s},set:function(t){this.s=t,a(this)}},thickness:{get:function(){return this.t},set:function(t){this.t=t,a(this)}},colorTop:{get:function(){return this.ct},set:function(t){this.ct=t,a(this)}},colorBottom:{get:function(){return this.cb},set:function(t){this.cb=t,a(this)}}}),window.At=s,window.Astatine=s,document.addEventListener("DOMContentLoaded",function(){a(window.Astatine.setup.spinner)})}();
