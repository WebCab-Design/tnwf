/*
	title: astatine
	version: 1.0.9
	author: alexander elias
*/
(function(){function l(a){if(!a)throw Error("At.ajax: requires options");a.action||(a.action=window.location.pathname);a.enctype||(a.enctype="text/plain");a.method=a.method?a.method.toUpperCase():"GET";a.data&&("GET"===a.method?(a.action=a.action+"?"+k(a.data),a.data=null):-1!==a.enctype.search("application/x-www-form-urlencoded")?a.data=k(a.data):-1!==a.enctype.search("application/json")&&(a.data=JSON.stringify(a.data)));var b=new XMLHttpRequest;b.open(a.method,a.action,!0,a.username,a.password);
a.mimeType&&b.overrideMimeType(a.mimeType);a.withCredentials&&(b.withCredentials=a.withCredentials);if(a.headers)for(var c in a.headers)b.setRequestHeader(c,a.headers[c]);b.onreadystatechange=function(){if(4===b.readyState)if(200<=b.status&&300>b.status){if(a.success)return a.success(b)}else if(a.error)return a.error(b)};b.send(a.data)}function k(a){var b="",c;for(c in a)b=0<b.length?b+"&":b,b=b+encodeURIComponent(c)+"="+encodeURIComponent(a[c]);return b}function m(a){a=a.querySelectorAll("input, textarea, select");
for(var b={},c=0,d=a.length;c<d;c++){var g=a[c],h=g.name,e=g.type,f=g.value,k=g.checked,l=g.disabled;if(h&&!l&&"submit"!==e&&"reset"!==e&&"button"!==e&&"file"!==e)if("checkbox"===e)b[h]=k;else if("radio"===e)k&&(b[h]=f);else if("select-one"===e||"select-multiple"===e){b[h]=[];e=0;for(f=g.selectedOptions.length;e<f;e++)b[h].push(g.selectedOptions[e].value);b[h]=b[h].join(", ")}else b[h]=f}return b}function n(a,b){var c="string"===typeof a?document.querySelector(a):a,d=document.createElement("div");
d.classList.add("spinner");c.appendChild(d);c.addEventListener("submit",function(a){a.preventDefault();a=a.target;var c=a.querySelector("[type=submit]");return b(a,c,d)})}function f(a){var b=document.head,c=b.querySelector("[title=Astatine]"),d=".spinner {margin: auto;display: none;width:  "+a.thickness+";height:  "+a.thickness+";border:  "+a.size+" solid "+a.colorBottom+";border-top: "+a.size+" solid "+a.colorTop+";border-radius: 50%;animation: spin 2s linear infinite;-o-animation: spin 2s linear infinite;-moz-animation: spin 2s linear infinite;-webkit-animation: spin 2s linear infinite;}@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }@-o-keyframes spin { 0% { -o-transform: rotate(0deg); } 100% { -o-transform: rotate(360deg); } }@-moz-keyframes spin { 0% { -moz-transform: rotate(0deg); } 100% { -moz-transform: rotate(360deg); } }@-webkit-keyframes spin { 0% { -webkit-transform: rotate(0deg); }100% { -webkit-transform: rotate(360deg); } }";
a=document.createElement("style");d=document.createTextNode(d);a.setAttribute("title","Astatine");a.appendChild(d);c?b.replaceChild(a,c):document.head.appendChild(a)}window.At={setup:{spinner:{s:"3px",t:"15px",ct:"darkgray",cb:"lightgray"}},ajax:l,submit:function(a){if(!a)throw Error("At.submit: requires options");if(!a.query)throw Error("At.submit: requires options.query");n(a.query,function(b,c,d){d&&(d.style.display="block");c&&(c.style.display="none");a.data=a.data||m(b);a.action=a.action||b.getAttribute("action");
a.method=a.method||b.getAttribute("method");a.enctype=a.enctype||b.getAttribute("enctype");a.headers=a.headers||{"Content-Type":a.enctype};a.prepare&&a.prepare(a.data);a.success=function(g){d&&(d.style.display="none");c&&(c.style.display="block");b.reset();if(a.complete)return a.complete(null,g)};a.error=function(b){d&&(d.style.display="none");c&&(c.style.display="block");a.data=null;if(a.complete)return a.complete(b,null)};l(a)})},formData:m,serialize:k};Object.defineProperties(window.At.setup.spinner,
{size:{get:function(){return this.s},set:function(a){this.s=a;f(this)}},thickness:{get:function(){return this.t},set:function(a){this.t=a;f(this)}},colorTop:{get:function(){return this.ct},set:function(a){this.ct=a;f(this)}},colorBottom:{get:function(){return this.cb},set:function(a){this.cb=a;f(this)}}});f(window.At.setup.spinner)})();
